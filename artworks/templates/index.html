{% extends "base.html" %}

{% block title %}Adopt public art today{% endblock title %}

{% block content %}
  <div id="home">

    <ul class="artworks">
    {% for artwork in artworks %}
      <li data-artwork-id="{{ artwork.id }}">
        <a href="/artwork/{{ artwork.id }}">
        <div class="image">
          <img src="{{ MEDIA_URL }}{{ artwork.artworkimage_set.all.0.image }}" alt="{{ artwork.description }}">
        </div>
        <div class="info">
          <h2>{{ artwork.title }}</h2>
          <div class="author">{{ artwork.artist_name }}</div>
        </div>
        </a>
      </li>
    {% endfor %}
    </ul>

    <div id="map"></div>

  </ul>
{% endblock content %}

{% block scripts %}
  <script>
    function initMap() {
      var map = new google.maps.Map(document.getElementById('map'), {
        center: new google.maps.LatLng(34.0639, -118.3592),
        zoom: 11,
        scrollwheel: false
      });

      var marker;

      {% for artwork in artworks %}
      var marker{{ forloop.counter }} = new google.maps.Marker({
        position: {
          lat: {{ artwork.lat }},
          lng: {{ artwork.lon }}
        },
        map: map,
        title: '{{ artwork.title }}'
      });
      {% endfor %}

      $('.artworks li').click(function () {
        // google.maps.event.trigger(marker, 'click');
      });
    }
  </script>
  <script async defer
  src="https://maps.googleapis.com/maps/api/js?key={{ GOOGLE_MAPS_API_KEY }}&callback=initMap">
  </script>
{% endblock scripts %}
